<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-03-06">
<meta name="description" content="Kedro Pipeline provides options allow you to slice and compose pipelines effortlessly">

<title>blog - Kedro Pipeline (1) - Slicing Pipeline Effortlessly üçï</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-28PTCJ2ELM"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-28PTCJ2ELM', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/noklam" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Kedro Pipeline (1) - Slicing Pipeline Effortlessly üçï</h1>
                  <div>
        <div class="description">
          Kedro Pipeline provides options allow you to slice and compose pipelines effortlessly
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">python</div>
                <div class="quarto-category">kedro</div>
                <div class="quarto-category">databricks</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#kedro-node-and-pipelines" id="toc-kedro-node-and-pipelines" class="nav-link active" data-scroll-target="#kedro-node-and-pipelines">Kedro Node and Pipelines</a>
  <ul class="collapse">
  <li><a href="#node-uniqueness" id="toc-node-uniqueness" class="nav-link" data-scroll-target="#node-uniqueness">Node Uniqueness</a></li>
  <li><a href="#pipeline-arithmetic" id="toc-pipeline-arithmetic" class="nav-link" data-scroll-target="#pipeline-arithmetic">Pipeline Arithmetic</a></li>
  <li><a href="#advance-pipeline-slicing" id="toc-advance-pipeline-slicing" class="nav-link" data-scroll-target="#advance-pipeline-slicing">Advance Pipeline Slicing</a></li>
  <li><a href="#more-notes" id="toc-more-notes" class="nav-link" data-scroll-target="#more-notes">More notes</a>
  <ul class="collapse">
  <li><a href="#the-pipeline.filter-support-or-operator" id="toc-the-pipeline.filter-support-or-operator" class="nav-link" data-scroll-target="#the-pipeline.filter-support-or-operator">The <code>Pipeline.filter</code> support <code>or</code> operator</a></li>
  <li><a href="#selecting-or-slicing-multiple-pipeline-with-kedro-run" id="toc-selecting-or-slicing-multiple-pipeline-with-kedro-run" class="nav-link" data-scroll-target="#selecting-or-slicing-multiple-pipeline-with-kedro-run">Selecting or slicing multiple pipeline with <code>kedro run</code></a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> kedro.pipeline <span class="im">import</span> pipeline, node</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> kedro.pipeline.node <span class="im">import</span> Node</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo():</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> <span class="st">"bar"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="kedro-node-and-pipelines" class="level1">
<h1>Kedro Node and Pipelines</h1>
<p>Kedro introduces the concepts of Nodes and Pipelines. A basic understanding of these concepts is assumed. However, if you‚Äôre unfamiliar, you can refer to the Nodes and Pipelines documentation for more details.</p>
<p>In essence, a Kedro Node acts as a thin wrapper around a Python function, specifying its inputs and outputs. On the other hand, a Pipeline is essentially a collection of Nodes that are strung together. When a pipeline is executed, Kedro resolves the dependencies between nodes to determine the correct order of execution.</p>
<p>While Kedro is primarily designed for data and machine learning applications, it can be utilized for executing any sequential tasks, including parallel processing if needed.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>node_a <span class="op">=</span> node(func<span class="op">=</span>foo, inputs<span class="op">=</span><span class="va">None</span>, outputs<span class="op">=</span><span class="st">"output_a"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>first_pipeline <span class="op">=</span> pipeline([])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>node_a, first_pipeline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>(Node(foo, None, 'output_a', None), Pipeline([]))</code></pre>
</div>
</div>
<p><code>pipeline</code> is a factory method that expects a list of <code>Node</code> and produce the <code>Pipeline</code> object. In this example, we have an empty <code>Pipeline</code>. Below is another valid example:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pipeline([node_a])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Pipeline([
Node(foo, None, 'output_a', None)
])</code></pre>
</div>
</div>
<section id="node-uniqueness" class="level2">
<h2 class="anchored" data-anchor-id="node-uniqueness">Node Uniqueness</h2>
<p>The pipeline in Kedro automatically validates Node instances. Specifically, nodes cannot produce the same output (though they can share the same input), and there cannot be duplicate nodes within the pipeline. This validation is crucial to ensure that the pipeline forms an executable Directed Acyclic Graph (DAG), allowing for proper execution and preventing any cyclic dependencies.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pipeline([node_a, node_a])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: Pipeline nodes must have unique names. The following node names appear more than once:

Free nodes:
  - foo(None) -&gt; [output_a]

You can name your nodes using the last argument of 'node()'.</code></pre>
</div>
</div>
<p>On the other hand, <code>Node</code> are considered equal if they have the same <code>inputs</code>, <code>outputs</code>and <code>function</code> (and node name if provided, it is an optional argument)</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>node_b <span class="op">=</span> node(foo, inputs<span class="op">=</span><span class="va">None</span>, outputs<span class="op">=</span><span class="st">"output_a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>node_b <span class="op">==</span> node_a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>True</code></pre>
</div>
</div>
<p>Internally, it is comparing the <code>name</code> attribute, which is a combination of namespace, function name, inputs and outputs. This is not important to most Kedro users and are only used by Kedro internally.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>node_a.name</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>'foo(None) -&gt; [output_a]'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Node.<span class="fu">__str__</span>??</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Signature: Node.__str__(self)
Docstring: Return str(self).
Source:   
    def __str__(self):
        def _set_to_str(xset):
            return f"[{','.join(xset)}]"

        out_str = _set_to_str(self.outputs) if self._outputs else "None"
        in_str = _set_to_str(self.inputs) if self._inputs else "None"

        prefix = self._name + ": " if self._name else ""
        return prefix + f"{self._func_name}({in_str}) -&gt; {out_str}"
File:      ~/miniconda3/envs/blog/lib/python3.10/site-packages/kedro/pipeline/node.py
Type:      function</code></pre>
</div>
</div>
</section>
<section id="pipeline-arithmetic" class="level2">
<h2 class="anchored" data-anchor-id="pipeline-arithmetic">Pipeline Arithmetic</h2>
<p>The closest analogy to <code>Pipeline</code> is the Python <code>set</code>. They share simliary characteristics: - The elements cannot be repeated. - Pipelines can be added or subtracted</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pipeline([node_a]) <span class="op">+</span> pipeline([node_a])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Pipeline([
Node(foo, None, 'output_a', None)
])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> node(foo, <span class="va">None</span>, <span class="st">"a"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> node(foo, <span class="va">None</span>, <span class="st">"b"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> node(foo, <span class="va">None</span>, <span class="st">"c"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> node(foo, <span class="va">None</span>, <span class="st">"d"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>original_set <span class="op">=</span> <span class="bu">set</span>([<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>original_pipeline <span class="op">=</span> pipeline([a,b,c])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pipeline([a]) <span class="op">+</span> pipeline([b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>Pipeline([
Node(foo, None, 'a', None),
Node(foo, None, 'b', None)
])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pipeline([a, b]) <span class="op">-</span> pipeline([b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>Pipeline([
Node(foo, None, 'a', None)
])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pipeline([a, b]) <span class="op">-</span> pipeline([a])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>Pipeline([
Node(foo, None, 'b', None)
])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>original_set<span class="op">|</span> <span class="bu">set</span>([<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>{'a', 'b', 'c', 'd'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pipeline([a,b,c])<span class="op">|</span> pipeline([b,c,d]) <span class="co"># nodes in both pipelines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>Pipeline([
Node(foo, None, 'a', None),
Node(foo, None, 'b', None),
Node(foo, None, 'c', None),
Node(foo, None, 'd', None)
])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>original_set <span class="op">&amp;</span> <span class="bu">set</span>([<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>{'b', 'c'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pipeline([a,b,c]) <span class="op">&amp;</span> pipeline([b,c,d]) <span class="co"># only nodes that exist in both pipelines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>Pipeline([
Node(foo, None, 'b', None),
Node(foo, None, 'c', None)
])</code></pre>
</div>
</div>
<p>Pipeline arithmetic is more useful for pipeline registration i.e.&nbsp;<code>pipeline_registry.py</code>. For example, you can combine your development pipeline and inference pipeline in different way.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fake_node(name):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node(foo, inputs<span class="op">=</span><span class="va">None</span>, outputs<span class="op">=</span>name, name<span class="op">=</span>name)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For simplicaition, let's assume each pipeline is just one single node.</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>spark_pipeline <span class="op">=</span> pipeline([fake_node(<span class="st">"spark"</span>)])</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>feature_engineering <span class="op">=</span> pipeline([fake_node(<span class="st">"feature_engineering"</span>)])</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>model_training <span class="op">=</span> pipeline([fake_node(<span class="st">"model_pipeline"</span>)])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>inference <span class="op">=</span> pipeline([fake_node(<span class="st">"inference"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With 4 base pipelines, you can combined them in different ways. For example you want a e2e pipeline which add all of them.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>e2e <span class="op">=</span> spark_pipeline <span class="op">+</span> feature_engineering <span class="op">+</span> model_training <span class="op">+</span> inference</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also have a <code>local</code> pipeline that skip only the <code>spark</code> pipeline.</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>local <span class="op">=</span> e2e <span class="op">-</span> spark_pipeline</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>local</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>Pipeline([
Node(foo, None, 'feature_engineering', 'feature_engineering'),
Node(foo, None, 'inference', 'inference'),
Node(foo, None, 'model_pipeline', 'model_pipeline')
])</code></pre>
</div>
</div>
</section>
<section id="advance-pipeline-slicing" class="level2">
<h2 class="anchored" data-anchor-id="advance-pipeline-slicing">Advance Pipeline Slicing</h2>
<p>Kedro provides an <a href="https://demo.kedro.org/">interaction visualisation</a> that you can play around with, for this post I am gonna stick with the demo project and explains concepts about Pipeline and how you can slice pipeline and compose them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hide</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext kedro.ipython</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd <span class="op">/</span>Users<span class="op">/</span>Nok_Lam_Chan<span class="op">/</span>dev<span class="op">/</span>kedro<span class="op">-</span>viz<span class="op">/</span>demo<span class="op">-</span>project</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reload_kedro <span class="op">/</span>Users<span class="op">/</span>Nok_Lam_Chan<span class="op">/</span>dev<span class="op">/</span>kedro<span class="op">-</span>viz<span class="op">/</span>demo<span class="op">-</span>project</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">[03/07/24 14:02:54] </span><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Reached after_catalog_created hook                                        <a href="file:///Users/Nok_Lam_Chan/dev/kedro/features/steps/test_plugin/plugin.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">plugin.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///Users/Nok_Lam_Chan/dev/kedro/features/steps/test_plugin/plugin.py#15" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">15</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Kedro project modular-spaceflights                                     <a href="file:///Users/Nok_Lam_Chan/dev/kedro/kedro/ipython/__init__.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">__init__.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///Users/Nok_Lam_Chan/dev/kedro/kedro/ipython/__init__.py#134" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">134</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Defined global variable <span style="color: #008000; text-decoration-color: #008000">'context'</span>, <span style="color: #008000; text-decoration-color: #008000">'session'</span>, <span style="color: #008000; text-decoration-color: #008000">'catalog'</span> and            <a href="file:///Users/Nok_Lam_Chan/dev/kedro/kedro/ipython/__init__.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">__init__.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///Users/Nok_Lam_Chan/dev/kedro/kedro/ipython/__init__.py#135" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">135</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #008000; text-decoration-color: #008000">'pipelines'</span>                                                            <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">               </span>
</pre>
</div>
</div>
<p>By using the <code>reload_kedro</code> inside a notebook, you can access the project <code>pipelines</code> object. Let‚Äôs say I want to filter out the <a href="https://demo.kedro.org/?pipeline_id=__default__&amp;selected_id=04ba733a">highlighted pipeline</a> like this (click on the ‚ÄúCreate Derived Features‚Äù): <img src="kedro-viz-selection.png" class="img-fluid" alt="Select a node on kedro-viz"></p>
<p>To filter this with the <code>Pipeline</code> API, you need two options. <code>from-nodes</code>(downstream) and <code>to-nodes</code> (upstream).</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pipelines.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div class="ansi-escaped-output">
<pre><span class="ansi-magenta-fg ansi-bold">dict_keys</span><span class="ansi-bold">(</span><span class="ansi-bold">[</span><span class="ansi-green-fg">'__default__'</span>, <span class="ansi-green-fg">'Data ingestion'</span>, <span class="ansi-green-fg">'Modelling stage'</span>, <span class="ansi-green-fg">'Feature engineering'</span>, <span class="ansi-green-fg">'Reporting stage'</span>, <span class="ansi-green-fg">'Pre-modelling'</span><span class="ansi-bold">]</span><span class="ansi-bold">)</span></pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>full_pipeline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div class="ansi-escaped-output">

<pre><span class="ansi-magenta-fg ansi-bold">Pipeline</span><span class="ansi-bold">(</span><span class="ansi-bold">[</span>
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>apply_types_to_companies, <span class="ansi-green-fg">'companies'</span>, <span class="ansi-green-fg">'ingestion.int_typed_companies'</span>, <span class="ansi-green-fg">'apply_types_to_companies'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>apply_types_to_reviews, <span class="ansi-bold">[</span><span class="ansi-green-fg">'reviews'</span>, <span class="ansi-green-fg">'params:ingestion.typing.reviews.columns_as_floats'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'ingestion.int_typed_reviews'</span>, <span class="ansi-green-fg">'apply_types_to_reviews'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>apply_types_to_shuttles, <span class="ansi-green-fg">'shuttles'</span>, <span class="ansi-green-fg">'ingestion.int_typed_shuttles@pandas1'</span>, <span class="ansi-green-fg">'apply_types_to_shuttles'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>aggregate_company_data, <span class="ansi-green-fg">'ingestion.int_typed_companies'</span>, <span class="ansi-green-fg">'ingestion.prm_agg_companies'</span>, <span class="ansi-green-fg">'company_agg'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>combine_shuttle_level_information, <span class="ansi-bold">{</span><span class="ansi-green-fg">'shuttles'</span>: <span class="ansi-green-fg">'ingestion.int_typed_shuttles@pandas2'</span>, <span class="ansi-green-fg">'reviews'</span>: <span class="ansi-green-fg">'ingestion.int_typed_reviews'</span>, <span class="ansi-green-fg">'companies'</span>: <span class="ansi-green-fg">'ingestion.prm_agg_companies'</span><span class="ansi-bold">}</span>, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'prm_spine_table'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'combine_step'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>create_derived_features, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_spine_table'</span>, <span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'params:feature_engineering.feature.derived'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'feature_engineering.feat_derived_features'</span>, <span class="ansi-green-fg">'create_derived_features'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>create_feature_importance, <span class="ansi-green-fg">'prm_spine_table'</span>, <span class="ansi-green-fg">'feature_importance_output'</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>create_static_features, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'params:feature_engineering.feature.static'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'feature_engineering.feat_static_features'</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span><span class="ansi-bold">&lt;</span><span class="ansi-bright-magenta-fg ansi-bold">lambda</span><span class="ansi-bold">&gt;</span>, <span class="ansi-green-fg">'prm_spine_table'</span>, <span class="ansi-green-fg">'ingestion.prm_spine_table_clone'</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>create_matplotlib_chart, <span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'reporting.confusion_matrix'</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-yellow-fg">...</span>
<span class="ansi-bold">]</span><span class="ansi-bold">)</span></pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>node_name <span class="op">=</span> <span class="st">"feature_engineering.create_derived_features"</span> <span class="co"># make s|apipeline</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>full_pipeline.<span class="bu">filter</span>(from_nodes<span class="op">=</span>[node_name], to_nodes<span class="op">=</span>[node_name])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div class="ansi-escaped-output">

<pre><span class="ansi-magenta-fg ansi-bold">Pipeline</span><span class="ansi-bold">(</span><span class="ansi-bold">[</span>
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>create_derived_features, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_spine_table'</span>, <span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'params:feature_engineering.feature.derived'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'feature_engineering.feat_derived_features'</span>, <span class="ansi-green-fg">'create_derived_features'</span><span class="ansi-bold">)</span>
<span class="ansi-bold">]</span><span class="ansi-bold">)</span></pre>
</div>
</div>
</div>
<p>This only select one node because by default the <code>filter</code> method apply both method as an <code>and</code> condition. So we need to apply the <code>filter</code> method separately.</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>full_pipeline.<span class="bu">filter</span>(from_nodes<span class="op">=</span>[node_name]) <span class="op">|</span> full_pipeline.<span class="bu">filter</span>(to_nodes<span class="op">=</span>[node_name])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div class="ansi-escaped-output">

<pre><span class="ansi-magenta-fg ansi-bold">Pipeline</span><span class="ansi-bold">(</span><span class="ansi-bold">[</span>
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>apply_types_to_companies, <span class="ansi-green-fg">'companies'</span>, <span class="ansi-green-fg">'ingestion.int_typed_companies'</span>, <span class="ansi-green-fg">'apply_types_to_companies'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>apply_types_to_reviews, <span class="ansi-bold">[</span><span class="ansi-green-fg">'reviews'</span>, <span class="ansi-green-fg">'params:ingestion.typing.reviews.columns_as_floats'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'ingestion.int_typed_reviews'</span>, <span class="ansi-green-fg">'apply_types_to_reviews'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>apply_types_to_shuttles, <span class="ansi-green-fg">'shuttles'</span>, <span class="ansi-green-fg">'ingestion.int_typed_shuttles@pandas1'</span>, <span class="ansi-green-fg">'apply_types_to_shuttles'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>aggregate_company_data, <span class="ansi-green-fg">'ingestion.int_typed_companies'</span>, <span class="ansi-green-fg">'ingestion.prm_agg_companies'</span>, <span class="ansi-green-fg">'company_agg'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>combine_shuttle_level_information, <span class="ansi-bold">{</span><span class="ansi-green-fg">'shuttles'</span>: <span class="ansi-green-fg">'ingestion.int_typed_shuttles@pandas2'</span>, <span class="ansi-green-fg">'reviews'</span>: <span class="ansi-green-fg">'ingestion.int_typed_reviews'</span>, <span class="ansi-green-fg">'companies'</span>: <span class="ansi-green-fg">'ingestion.prm_agg_companies'</span><span class="ansi-bold">}</span>, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'prm_spine_table'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'combine_step'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>create_derived_features, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_spine_table'</span>, <span class="ansi-green-fg">'prm_shuttle_company_reviews'</span>, <span class="ansi-green-fg">'params:feature_engineering.feature.derived'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'feature_engineering.feat_derived_features'</span>, <span class="ansi-green-fg">'create_derived_features'</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>joiner, <span class="ansi-bold">[</span><span class="ansi-green-fg">'prm_spine_table'</span>, <span class="ansi-green-fg">'feature_engineering.feat_static_features'</span>, <span class="ansi-green-fg">'feature_engineering.feat_derived_features'</span><span class="ansi-bold">]</span>, <span class="ansi-green-fg">'model_input_table'</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>split_data, <span class="ansi-bold">[</span><span class="ansi-green-fg">'model_input_table'</span>, <span class="ansi-green-fg">'params:split_options'</span><span class="ansi-bold">]</span>, <span class="ansi-bold">[</span><span class="ansi-green-fg">'X_train'</span>, <span class="ansi-green-fg">'X_test'</span>, <span class="ansi-green-fg">'y_train'</span>, <span class="ansi-green-fg">'y_test'</span><span class="ansi-bold">]</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>train_model, <span class="ansi-bold">[</span><span class="ansi-green-fg">'X_train'</span>, <span class="ansi-green-fg">'y_train'</span>, <span class="ansi-green-fg">'params:train_evaluation.model_options.linear_regression'</span><span class="ansi-bold">]</span>, <span class="ansi-bold">[</span><span class="ansi-green-fg">'train_evaluation.linear_regression.regressor'</span>, <span class="ansi-green-fg">'train_evaluation.linear_regression.experiment_params'</span><span class="ansi-bold">]</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-magenta-fg ansi-bold">Node</span><span class="ansi-bold">(</span>train_model, <span class="ansi-bold">[</span><span class="ansi-green-fg">'X_train'</span>, <span class="ansi-green-fg">'y_train'</span>, <span class="ansi-green-fg">'params:train_evaluation.model_options.random_forest'</span><span class="ansi-bold">]</span>, <span class="ansi-bold">[</span><span class="ansi-green-fg">'train_evaluation.random_forest.regressor'</span>, <span class="ansi-green-fg">'train_evaluation.random_forest.experiment_params'</span><span class="ansi-bold">]</span>, <span style="font-style:italic" class="ansi-magenta-fg">None</span><span class="ansi-bold">)</span>,
<span class="ansi-yellow-fg">...</span>
<span class="ansi-bold">]</span><span class="ansi-bold">)</span></pre>
</div>
</div>
</div>
<p>Now we get the correct filtered pipeline as expected.</p>
</section>
<section id="more-notes" class="level2">
<h2 class="anchored" data-anchor-id="more-notes">More notes</h2>
<section id="the-pipeline.filter-support-or-operator" class="level3">
<h3 class="anchored" data-anchor-id="the-pipeline.filter-support-or-operator">The <code>Pipeline.filter</code> support <code>or</code> operator</h3>
<p>While the current filter supports many options, there may be some value to wrap around the Pipeline API to support things like <code>or</code>. This is only possible if you use the Python API directly but not CLI (with the example above). maybe something similar to the <a href="https://docs.getdbt.com/reference/node-selection/graph-operators">Graph Operators in dbt</a>.</p>
<p>e.g.&nbsp;</p>
<pre><code>kedro run --select "my_model+"         # select my_model and all children
kedro run --select "+my_model"         # select my_model and all parents
kedro run --select "+my_model+"        # select my_model, and all of its parents and children</code></pre>
</section>
<section id="selecting-or-slicing-multiple-pipeline-with-kedro-run" class="level3">
<h3 class="anchored" data-anchor-id="selecting-or-slicing-multiple-pipeline-with-kedro-run">Selecting or slicing multiple pipeline with <code>kedro run</code></h3>
<p>Since Pipeline API support arithmetic, it would be quite straight forward to support things like <code>kedro run --pipeline a+b</code> or <code>kedro run --pipeline a-b</code>. Let‚Äôs have a look what‚Äôs options are available for the CLI.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>kedro run <span class="op">--</span><span class="bu">help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Usage: kedro run [OPTIONS]

  Run the pipeline.

Options:
  --from-inputs TEXT         A list of dataset names which should be used as a
                             starting point.
  --to-outputs TEXT          A list of dataset names which should be used as
                             an end point.
  --from-nodes TEXT          A list of node names which should be used as a
                             starting point.
  --to-nodes TEXT            A list of node names which should be used as an
                             end point.
  -n, --nodes TEXT           Run only nodes with specified names.
  -r, --runner TEXT          Specify a runner that you want to run the
                             pipeline with. Available runners:
                             'SequentialRunner', 'ParallelRunner' and
                             'ThreadRunner'.
  --async                    Load and save node inputs and outputs
                             asynchronously with threads. If not specified,
                             load and save datasets synchronously.
  -e, --env TEXT             Kedro configuration environment name. Defaults to
                             `local`.
  -t, --tags TEXT            Construct the pipeline using only nodes which
                             have this tag attached. Option can be used
                             multiple times, what results in a pipeline
                             constructed from nodes having any of those tags.
  -lv, --load-versions TEXT  Specify a particular dataset version (timestamp)
                             for loading.
  -p, --pipeline TEXT        Name of the registered pipeline to run. If not
                             set, the '__default__' pipeline is run.
  -ns, --namespace TEXT      Name of the node namespace to run.
  -c, --config FILE          Specify a YAML configuration file to load the run
                             command arguments from. If command line arguments
                             are provided, they will override the loaded ones.
  --conf-source PATH         Path of a directory where project configuration
                             is stored.
  --params TEXT              Specify extra parameters that you want to pass to
                             the context initialiser. Items must be separated
                             by comma, keys - by colon or equals sign,
                             example: param1=value1,param2=value2. Each
                             parameter is split by the first comma, so
                             parameter values are allowed to contain colons,
                             parameter keys are not. To pass a nested
                             dictionary as parameter, separate keys by '.',
                             example: param_group.param1:value1.
  -h, --help                 Show this message and exit.</code></pre>
</div>
</div>
<p>This is what happen when you do <code>kedro run -p training -t model_a</code>, it‚Äôs a two steps flitering: 1. Apply the <code>-p</code> pipeline name to select a key from the pipeline dictionary, it‚Äôs just <code>pipelines[pipeline_name]</code>, note this mean you can only select ONE pipeline at a time. 2. The pipeline is then further filtered with <code>Pipeline.filter</code></p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> kedro.pipeline.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Pipeline.<span class="bu">filter</span>??</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Signature:
Pipeline.filter(
    self,
    tags: 'Iterable[str] | None' = None,
    from_nodes: 'Iterable[str] | None' = None,
    to_nodes: 'Iterable[str] | None' = None,
    node_names: 'Iterable[str] | None' = None,
    from_inputs: 'Iterable[str] | None' = None,
    to_outputs: 'Iterable[str] | None' = None,
    node_namespace: 'str | None' = None,
) -&gt; 'Pipeline'
Source:   
    def filter(  # noqa: PLR0913
        self,
        tags: Iterable[str] | None = None,
        from_nodes: Iterable[str] | None = None,
        to_nodes: Iterable[str] | None = None,
        node_names: Iterable[str] | None = None,
        from_inputs: Iterable[str] | None = None,
        to_outputs: Iterable[str] | None = None,
        node_namespace: str | None = None,
    ) -&gt; Pipeline:
        """Creates a new ``Pipeline`` object with the nodes that meet all of the
        specified filtering conditions.

        The new pipeline object is the intersection of pipelines that meet each
        filtering condition. This is distinct from chaining multiple filters together.

        Args:
            tags: A list of node tags which should be used to lookup
                the nodes of the new ``Pipeline``.
            from_nodes: A list of node names which should be used as a
                starting point of the new ``Pipeline``.
            to_nodes:  A list of node names which should be used as an
                end point of the new ``Pipeline``.
            node_names: A list of node names which should be selected for the
                new ``Pipeline``.
            from_inputs: A list of inputs which should be used as a starting point
                of the new ``Pipeline``
            to_outputs: A list of outputs which should be the final outputs of
                the new ``Pipeline``.
            node_namespace: One node namespace which should be used to select
                nodes in the new ``Pipeline``.

        Returns:
            A new ``Pipeline`` object with nodes that meet all of the specified
                filtering conditions.

        Raises:
            ValueError: The filtered ``Pipeline`` has no nodes.

        Example:
        ::

            &gt;&gt;&gt; pipeline = Pipeline(
            &gt;&gt;&gt;     [
            &gt;&gt;&gt;         node(func, "A", "B", name="node1"),
            &gt;&gt;&gt;         node(func, "B", "C", name="node2"),
            &gt;&gt;&gt;         node(func, "C", "D", name="node3"),
            &gt;&gt;&gt;     ]
            &gt;&gt;&gt; )
            &gt;&gt;&gt; pipeline.filter(node_names=["node1", "node3"], from_inputs=["A"])
            &gt;&gt;&gt; # Gives a new pipeline object containing node1 and node3.
        """
        # Use [node_namespace] so only_nodes_with_namespace can follow the same
        # *filter_args pattern as the other filtering methods, which all take iterables.
        node_namespace_iterable = [node_namespace] if node_namespace else None

        filter_methods = {
            self.only_nodes_with_tags: tags,
            self.from_nodes: from_nodes,
            self.to_nodes: to_nodes,
            self.only_nodes: node_names,
            self.from_inputs: from_inputs,
            self.to_outputs: to_outputs,
            self.only_nodes_with_namespace: node_namespace_iterable,
        }

        subset_pipelines = {
            filter_method(*filter_args)  # type: ignore
            for filter_method, filter_args in filter_methods.items()
            if filter_args
        }

        # Intersect all the pipelines subsets. We apply each filter to the original
        # pipeline object (self) rather than incrementally chaining filter methods
        # together. Hence the order of filtering does not affect the outcome, and the
        # resultant pipeline is unambiguously defined.
        # If this were not the case then, for example,
        # pipeline.filter(node_names=["node1", "node3"], from_inputs=["A"])
        # would give different outcomes depending on the order of filter methods:
        # only_nodes and then from_inputs would give node1, while only_nodes and then
        # from_inputs would give node1 and node3.
        filtered_pipeline = Pipeline(self.nodes)
        for subset_pipeline in subset_pipelines:
            filtered_pipeline &amp;= subset_pipeline

        if not filtered_pipeline.nodes:
            raise ValueError(
                "Pipeline contains no nodes after applying all provided filters"
            )
        return filtered_pipeline
File:      ~/dev/kedro/kedro/pipeline/pipeline.py
Type:      function</code></pre>
</div>
</div>
<p>This means that, if you have tags applied across multiple pipeline, you cannot filter it by tag, unless you apply the filter in the largest pipeline that contains all nodes. What if we can support things like: <code>kedro run -p feature+training -t model_a</code>?</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>